#!/bin/bash
# window-app.sh - Exibe apenas o nome e o √≠cone do aplicativo em foco.

export LANG=pt_BR.UTF-8
export LC_ALL=pt_BR.UTF-8

# 1. OBT√âM OS DADOS DA JANELA (CLASSE e T√çTULO)
WINDOW_INFO=$(i3-msg -t get_tree | jq -r '
    .. | objects | select(.focused==true and .name).name as $title | select(.focused==true and .window_properties).window_properties.class as $class | 
    {title: $title, class: $class}
' 2>/dev/null)

# Extrai a classe (ex: 'Firefox', 'Spotify')
APP_CLASS=$(echo "$WINDOW_INFO" | jq -r '.class // empty')
# Extrai o t√≠tulo (usado apenas para o fallback "√Årea de trabalho")
APP_TITLE=$(echo "$WINDOW_INFO" | jq -r '.title // empty')

# 2. TRATAMENTO DE ERROS E ESTADO PADR√ÉO
if [[ -z "$APP_CLASS" || "$APP_CLASS" == "null" ]]; then
    APP_CLASS="i3-wm"
    APP_TITLE="√Årea de trabalho"
fi

# 3. MAPPING DE √çCONES (APENAS OS SEUS APPS)
# Sugest√£o: Se voc√™ usar Nerd Fonts, substitua os emojis pelos c√≥digos hexadecimais para melhor renderiza√ß√£o!
ICON="ÔÑà" # √çcone padr√£o (ex: Desktop)

case "$APP_CLASS" in
    "Spotify")
        ICON="üéµ" 
        APP_NAME="Spotify"
        ;;
    "firefox"|"Firefox")
        ICON="ü¶ä" 
        APP_NAME="Firefox"
        ;;
    # ADICIONE A CL√ÅUSULA DO BRAVE AQUI
    "Brave-browser")
        ICON="ü¶Å"  # √çcone para o Brave (ex: le√£o ou 'Ôâπ' da Nerd Font)
        APP_NAME="Brave"
        ;;
    # O Alacritty costuma ter a classe "Alacritty"
    "Alacritty")
        ICON="ÔÑ†" 
        APP_NAME="Alacritty"
        ;;
    "Code")
        # O VSCode e VSCodium geralmente usam a classe "Code"
        ICON="VSCode" 
        APP_NAME="VS Code"
        ;;
    "Thunar")
        ICON="üìÅ" 
        APP_NAME="Thunar"
        ;;
    # Caso para qualquer outra janela n√£o mapeada
    *)
        # Capitaliza a primeira letra da classe (ex: 'gimp' -> 'Gimp')
        APP_NAME=$(printf "%s" "$APP_CLASS" | sed 's/\(.\)/\U\1/')
        ;;
esac

# 4. SA√çDA FINAL (Icone e Nome do App)
printf "%s\n" "<span color='#b4befe'>$ICON  $APP_NAME</span>"

exit 0
